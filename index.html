<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>活動記録</title>
  <style>
    /* CSS スタイル */
  </style>
</head>
<body>
  <h1>活動記録</h1>

  <form id="activity-form">
    <label for="activity-input">活動名:</label>
    <input type="text" id="activity-input">
    <button type="submit">追加</button>
  </form>

  <ul id="activity-list">
    <!-- 活動項目がここに追加されます -->
  </ul>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var activityForm = document.getElementById("activity-form");
      var activityInput = document.getElementById("activity-input");
      var activityList = document.getElementById("activity-list");

      // 活動データをローカルストレージから読み込む
      var activities = JSON.parse(localStorage.getItem("activities")) || [];

      // 活動項目を表示する関数
      function renderActivity(activity, index) {
        var activityItem = document.createElement("li");
        activityItem.textContent = activity.name + " (開始時刻: " + activity.startTime + ")";
        
        var deleteButton = document.createElement("button");
        deleteButton.textContent = "削除";
        deleteButton.addEventListener("click", function() {
          deleteActivity(index);
        });

        var updateButton = document.createElement("button");
        updateButton.textContent = "開始時刻更新";
        updateButton.addEventListener("click", function() {
          updateActivity(index);
        });

        var elapsedTime = document.createElement("span"); // 経過時間表示用の要素
        activityItem.appendChild(elapsedTime);
        activityItem.appendChild(deleteButton);
        activityItem.appendChild(updateButton);
        activityList.appendChild(activityItem);

        // 経過時間を更新する関数
        function updateElapsedTime() {
          var currentTime = new Date();
          var startTime = new Date(activity.startTime);
          var elapsed = currentTime - startTime;
          var seconds = Math.floor(elapsed / 1000);
          var minutes = Math.floor(seconds / 60);
          var hours = Math.floor(minutes / 60);
          elapsedTime.textContent = " 経過時間: " + hours + "時間 " + minutes % 60 + "分 " + seconds % 60 + "秒";
        }

        // 1秒ごとに経過時間を更新
        setInterval(updateElapsedTime, 1000);
      }

      // 活動項目を保存する関数
      function saveActivities() {
        localStorage.setItem("activities", JSON.stringify(activities));
      }

      // 活動項目を追加するイベントハンドラ
      activityForm.addEventListener("submit", function(event) {
        event.preventDefault();
        var activityName = activityInput.value;
        var startTime = new Date().toLocaleString(); // 現在時刻を取得
        var activity = {
          name: activityName,
          startTime: startTime
        };
        activities.push(activity);
        renderActivity(activity, activities.length - 1);
        saveActivities();
        activityInput.value = "";
      });

      // 活動項目を削除する関数
      function deleteActivity(index) {
        activities.splice(index, 1);
        activityList.innerHTML = "";
        activities.forEach(renderActivity);
        saveActivities();
      }

      // 活動項目の開始時刻を更新する関数
      function updateActivity(index) {
        activities[index].startTime = new Date().toLocaleString();
        activityList.innerHTML = "";
        activities.forEach(renderActivity);
        saveActivities();
      }

      // ローカルストレージから読み込んだ活動項目を表示
      activities.forEach(renderActivity);
    });
  </script>
</body>
</html>
